<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>LOKA PRO | Ù„ÙˆÙƒØ§ Ø¨Ø±Ùˆ - Ù†Ø¸Ø§Ù… Ø§Ù„ÙØ²Ø¹Ø©</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        :root { --primary: #007aff; --bg: #000; --glass: rgba(28, 28, 28, 0.85); --accent: #34c759; --warning: #ff9500; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-family: -apple-system, sans-serif; }
        body { margin: 0; background: var(--bg); color: white; overflow: hidden; height: 100vh; }

        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚ */
        #splash { position: fixed; inset: 0; background: #000; z-index: 10000; display: flex; align-items: center; justify-content: center; transition: 0.8s; }
        .logo-vibe { font-size: 45px; font-weight: 900; letter-spacing: -2px; }
        .logo-vibe span { color: var(--primary); }

        /* Ù†Ø¸Ø§Ù… Ø§Ù„Ø´Ø§Ø´Ø§Øª */
        .screen { position: absolute; inset: 0; display: flex; flex-direction: column; transition: 0.5s cubic-bezier(0.4, 0, 0.2, 1); background: var(--bg); padding-top: env(safe-area-inset-top); z-index: 5; }
        .hidden { transform: translateY(50px); opacity: 0; pointer-events: none; }

        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ© */
        .horizontal-nav { display: flex; overflow-x: auto; padding: 15px; gap: 12px; scrollbar-width: none; }
        .nav-card { flex: 0 0 100px; background: var(--glass); padding: 15px; border-radius: 22px; text-align: center; border: 1px solid rgba(255,255,255,0.1); }
        .nav-card.active { background: var(--primary); }

        /* Ø§Ù„Ø®Ø±ÙŠØ·Ø© */
        #map { flex: 1; margin: 0; overflow: hidden; position: relative; }

        /* Ø¨Ø·Ø§Ù‚Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙƒØ§Ø¨ØªÙ† (ØªØ¸Ù‡Ø± Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø±) */
        #driver-card { 
            position: absolute; bottom: 100px; left: 15px; right: 15px; 
            background: var(--glass); backdrop-filter: blur(20px); 
            border-radius: 30px; padding: 20px; border: 1px solid rgba(255,255,255,0.1);
            transform: translateY(200%); transition: 0.5s ease; z-index: 1000;
        }
        #driver-card.show { transform: translateY(0); }

        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© ÙˆØ§Ù„Ù…ÙØ§ÙˆØ¶Ø© */
        #chat-area { flex: 1; padding: 20px; overflow-y: auto; background: #0a0a0a; display: flex; flex-direction: column; gap: 10px; }
        .msg { padding: 12px 18px; border-radius: 20px; max-width: 80%; font-size: 15px; }
        .msg.sent { background: var(--primary); align-self: flex-start; }
        .msg.received { background: #2c2c2e; align-self: flex-end; }

        .chat-input { padding: 15px; background: #1c1c1e; display: flex; gap: 10px; align-items: center; }
        .chat-input input { flex: 1; background: transparent; border: none; color: white; outline: none; }

        .btn-action { padding: 12px; border-radius: 15px; border: none; font-weight: bold; cursor: pointer; }
        .btn-chat { background: var(--accent); color: white; width: 100%; margin-top: 10px; }

        .star { color: var(--warning); font-size: 14px; }
    </style>
</head>
<body>

    <div id="splash">
        <div class="logo-vibe">LOKA<span>PRO</span></div>
    </div>

    <div id="screen-home" class="screen">
        <div style="padding: 15px 20px 5px; display:flex; justify-content:space-between; align-items:center;">
            <h2 style="margin:0;">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h2>
            <div style="font-size:12px; background:rgba(255,255,255,0.1); padding:5px 12px; border-radius:20px;">ğŸ“ Ø§Ù„Ù…Ù…Ù„ÙƒØ©</div>
        </div>

        <div class="horizontal-nav">
            <div class="nav-card active" onclick="startSearch('Ø³Ø·Ø­Ø©')"><i>ğŸï¸</i><br><span>Ø³Ø·Ø­Ø©</span></div>
            <div class="nav-card" onclick="startSearch('Ù†Ù‚Ù„ Ø¹ÙØ´')"><i>ğŸ“¦</i><br><span>Ø¹ÙØ´</span></div>
            <div class="nav-card" onclick="startSearch('ØªØ±ÙŠÙ„Ø§Øª')"><i>ğŸš›</i><br><span>ØªØ±ÙŠÙ„Ø§Øª</span></div>
            <div class="nav-card" onclick="startSearch('ÙØ²Ø¹Ø©')"><i>ğŸ› ï¸</i><br><span>ÙØ²Ø¹Ø©</span></div>
        </div>

        <div id="map">
            <div id="driver-card">
                <div style="display:flex; align-items:center; gap:15px">
                    <div style="width:50px; height:50px; background:#444; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:24px;">ğŸ‘¤</div>
                    <div style="flex:1">
                        <h4 id="d-name" style="margin:0">Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯</h4>
                        <div id="d-rating" class="star">â­â­â­â­â­ <span style="color:#888; font-size:12px;">(4.9)</span></div>
                    </div>
                    <div style="text-align:left">
                        <div id="d-dist" style="color:var(--accent); font-weight:bold;">1.2 ÙƒÙ…</div>
                        <div style="font-size:10px; color:#666;">ÙŠØ¨Ø¹Ø¯ Ø¹Ù†Ùƒ</div>
                    </div>
                </div>
                <button class="btn-action btn-chat" onclick="openChat()">Ø¨Ø¯Ø¡ Ø§Ù„Ù…ÙØ§ÙˆØ¶Ø© ÙˆØ§Ù„Ø¯Ø±Ø¯Ø´Ø©</button>
            </div>
        </div>
    </div>

    <div id="screen-chat" class="screen hidden">
        <div style="padding:15px; border-bottom:1px solid #222; display:flex; align-items:center; gap:15px">
            <button onclick="showScreen('screen-home')" style="background:none; border:none; color:white; font-size:20px;">âœ•</button>
            <div>
                <b id="chat-with">Ø§Ù„Ù…ÙØ§ÙˆØ¶Ø© Ù…Ø¹ Ø£Ø­Ù…Ø¯</b><br>
                <small style="color:var(--accent)">Ù…ØªØµÙ„ Ø§Ù„Ø¢Ù† - Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø¹Ø±Ø¶Ùƒ</small>
            </div>
        </div>
        <div id="chat-area">
            <div class="msg received">Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ…ØŒ Ø´ÙØª Ø·Ù„Ø¨Ùƒ Ù„Ù„Ø³Ø·Ø­Ø©. Ø£Ù†Ø§ Ù‚Ø±ÙŠØ¨ Ù…Ù†Ùƒ ÙˆÙ…Ø³ØªØ¹Ø¯.</div>
            <div class="msg sent">ÙˆØ¹Ù„ÙŠÙƒÙ… Ø§Ù„Ø³Ù„Ø§Ù…ØŒ ÙƒÙ… Ø§Ù„Ø³Ø¹Ø± Ù„Ø§Ù‡Ù†ØªØŸ</div>
            <div class="msg received">Ø§Ù„Ù…Ø´ÙˆØ§Ø± Ø¨Ù€ 150 Ø±ÙŠØ§Ù„ Ø´Ø§Ù…Ù„ ÙƒÙ„ Ø´ÙŠØ¡.</div>
        </div>
        <div class="chat-input">
            <input type="text" placeholder="Ø§ÙƒØªØ¨ Ø¹Ø±Ø¶Ùƒ Ø§Ù„Ø³Ø¹Ø±ÙŠ Ù‡Ù†Ø§...">
            <button style="background:var(--primary); border:none; color:white; padding:10px 20px; border-radius:10px;">Ø¥Ø±Ø³Ø§Ù„</button>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        let map;
        let userMarker;
        let drivers = [
            { id: 1, name: "Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ø¹ØªÙŠØ¨ÙŠ", lat: 0.005, lng: 0.005, rate: "4.8", dist: "800 Ù…ØªØ±" },
            { id: 2, name: "Ø®Ø§Ù„Ø¯ Ø§Ù„Ø´Ù…Ø±ÙŠ", lat: -0.003, lng: 0.008, rate: "4.9", dist: "1.5 ÙƒÙ…" },
            { id: 3, name: "Ø³Ø¹ÙŠØ¯ Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ", lat: 0.009, lng: -0.002, rate: "4.7", dist: "2.1 ÙƒÙ…" }
        ];

        window.onload = () => {
            setTimeout(() => {
                document.getElementById('splash').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('splash').style.display = 'none';
                    initMap();
                }, 800);
            }, 2000);
        };

        function initMap() {
            map = L.map('map', { zoomControl: false }).setView([24.7136, 46.6753], 13);
            L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png').addTo(map);

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition((pos) => {
                    const lat = pos.coords.latitude;
                    const lng = pos.coords.longitude;
                    map.setView([lat, lng], 15);
                    
                    // Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                    L.circleMarker([lat, lng], { radius: 10, color: '#007aff', fillOpacity: 1 }).addTo(map);
                    
                    // ØªÙˆØ²ÙŠØ¹ ÙƒØ¨Ø§ØªÙ† ÙˆÙ‡Ù…ÙŠÙŠÙ† Ø­ÙˆÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ù„Ù…Ø­Ø§ÙƒØ§Ø©
                    drivers.forEach(d => {
                        let m = L.marker([lat + d.lat, lng + d.lng]).addTo(map);
                        m.on('click', () => showDriverInfo(d));
                    });
                });
            }
        }

        function showDriverInfo(d) {
            document.getElementById('d-name').innerText = d.name;
            document.getElementById('d-dist').innerText = d.dist;
            document.getElementById('d-rating').innerHTML = `â­`.repeat(Math.floor(d.rate)) + ` <span style="color:#888">(${d.rate})</span>`;
            document.getElementById('driver-card').classList.add('show');
        }

        function openChat() {
            const name = document.getElementById('d-name').innerText;
            document.getElementById('chat-with').innerText = "Ø§Ù„Ù…ÙØ§ÙˆØ¶Ø© Ù…Ø¹ " + name;
            showScreen('screen-chat');
        }

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
        }

        function startSearch(type) {
            alert("Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£Ù‚Ø±Ø¨ " + type + " ÙÙŠ Ù…Ù†Ø·Ù‚ØªÙƒ...");
            document.getElementById('driver-card').classList.remove('show');
        }
    </script>
</body>
</html>
