<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="LOKA PRO">
    <link rel="apple-touch-icon" href="https://ui-avatars.com/api/?name=L&background=007aff&color=fff&size=512">
    <title>LOKA PRO | Official App</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        :root { --primary: #007aff; --bg: #000; --card: #1c1c1e; --glass: rgba(30, 30, 30, 0.7); }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body { margin: 0; font-family: -apple-system, system-ui; background: var(--bg); color: white; overflow: hidden; height: 100vh; }

        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© */
        #splash { position: fixed; inset: 0; background: #000; z-index: 10000; display: flex; align-items: center; justify-content: center; transition: 0.6s ease-out; }
        .logo-vibe { font-size: 40px; font-weight: 900; letter-spacing: -1.5px; }
        .logo-vibe span { color: var(--primary); }

        /* Ù†Ø¸Ø§Ù… Ø§Ù„Ø´Ø§Ø´Ø§Øª */
        .screen { position: absolute; inset: 0; display: flex; flex-direction: column; transition: 0.5s cubic-bezier(0.4, 0, 0.2, 1); background: var(--bg); padding-top: env(safe-area-inset-top); z-index: 5; }
        .hidden { transform: translateX(100%); opacity: 0; pointer-events: none; }

        /* Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ø¨ØµØ±ÙŠØ© (Ù†Øµ Ø¨Ø§Ù‡Øª) */
        .watermark { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-25deg); font-size: 100px; font-weight: 900; color: rgba(255,255,255,0.02); pointer-events: none; z-index: 0; }

        /* Ø§Ù„Ø®Ø±ÙŠØ·Ø© */
        #map { flex: 1; z-index: 1; }

        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ© (Ø§Ù„Ø³Ø·Ø­Ø§Øª ÙˆØ§Ù„Ø«Ù‚ÙŠÙ„) */
        .h-nav { display: flex; overflow-x: auto; padding: 15px; gap: 12px; background: rgba(0,0,0,0.5); backdrop-filter: blur(20px); z-index: 10; scrollbar-width: none; }
        .h-nav::-webkit-scrollbar { display: none; }
        .nav-item { flex: 0 0 100px; background: var(--card); padding: 15px; border-radius: 20px; text-align: center; border: 1px solid rgba(255,255,255,0.05); }
        .nav-item.active { background: var(--primary); border-color: var(--primary); }

        /* Ø¨Ø·Ø§Ù‚Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙƒØ§Ø¨ØªÙ† */
        .driver-info { 
            position: absolute; bottom: 100px; left: 15px; right: 15px; background: var(--glass); 
            backdrop-filter: blur(25px); border-radius: 25px; padding: 20px; z-index: 1000;
            border: 1px solid rgba(255,255,255,0.1); transform: translateY(200%); transition: 0.4s cubic-bezier(0.17, 0.89, 0.32, 1.28);
        }
        .driver-info.active { transform: translateY(0); }

        /* Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© ÙˆØ§Ù„Ù…ÙØ§ÙˆØ¶Ø© */
        .chat-box { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 10px; background: #0a0a0a; }
        .bubble { padding: 12px 18px; border-radius: 20px; max-width: 80%; font-size: 15px; }
        .bubble.me { background: var(--primary); align-self: flex-start; }
        .bubble.them { background: #2c2c2e; align-self: flex-end; }

        /* Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„Ø³ÙÙ„ÙŠ */
        .tab-bar { height: calc(65px + env(safe-area-inset-bottom)); background: rgba(15,15,15,0.9); backdrop-filter: blur(20px); display: flex; justify-content: space-around; align-items: center; padding-bottom: env(safe-area-inset-bottom); border-top: 0.5px solid #333; }
        .tab { color: #555; font-size: 22px; transition: 0.3s; }
        .tab.active { color: var(--primary); transform: translateY(-3px); }

        /* Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª */
        .opt-row { background: var(--card); padding: 18px; border-radius: 18px; margin: 0 15px 10px; display: flex; justify-content: space-between; align-items: center; }
        .toggle { width: 45px; height: 24px; background: #333; border-radius: 12px; position: relative; }
        .toggle.on { background: var(--primary); }
        .toggle::after { content: ''; position: absolute; width: 20px; height: 20px; background: white; border-radius: 50%; top: 2px; left: 2px; transition: 0.2s; }
        .toggle.on::after { left: 23px; }

        input { width: 100%; padding: 18px; border-radius: 15px; border: none; background: var(--card); color: white; margin-bottom: 15px; text-align: center; }
        .btn { width: 100%; padding: 18px; border-radius: 15px; background: var(--primary); color: white; border: none; font-weight: bold; }
    </style>
</head>
<body>

    <div class="watermark">LOKA PRO</div>

    <div id="splash">
        <div class="logo-vibe">LOKA<span>PRO</span></div>
    </div>

    <div id="scr-auth" class="screen">
        <div style="flex:1; display:flex; flex-direction:column; justify-content:center; padding:30px;">
            <h1 style="text-align:center; font-size:35px; margin-bottom:40px;">LOKA <span style="color:var(--primary)">PRO</span></h1>
            <input type="tel" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„">
            <button class="btn" onclick="showScr('scr-home')">Ø¯Ø®ÙˆÙ„ Ø¢Ù…Ù†</button>
            <p style="color:#444; font-size:11px; text-align:center; margin-top:20px;">Ø¨Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£Ù†Øª ØªÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø­Ù‚ÙˆÙ‚ ÙˆØ§Ù„Ø£Ù…Ø§Ù†</p>
        </div>
    </div>

    <div id="scr-home" class="screen hidden">
        <div class="h-nav">
            <div class="nav-item active"><i>ğŸï¸</i><br><span>Ø³Ø·Ø­Ø©</span></div>
            <div class="nav-item"><i>ğŸ“¦</i><br><span>Ø¹ÙØ´</span></div>
            <div class="nav-item"><i>ğŸ—ï¸</i><br><span>Ø«Ù‚ÙŠÙ„</span></div>
            <div class="nav-item"><i>ğŸš›</i><br><span>ØªØ±ÙŠÙ„Ø§Øª</span></div>
            <div class="nav-item"><i>ğŸ› ï¸</i><br><span>ÙØ²Ø¹Ø©</span></div>
        </div>
        
        <div id="map"></div>

        <div class="driver-info" id="driver-card">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <div style="display:flex; gap:12px; align-items:center;">
                    <div style="width:50px; height:50px; background:var(--primary); border-radius:50%; display:flex; align-items:center; justify-content:center;">ğŸ‘¤</div>
                    <div>
                        <b id="d-name">ÙÙ‡Ø¯ Ø§Ù„Ø´Ù…Ø±ÙŠ</b><br>
                        <span style="color:var(--primary); font-size:12px;">â­ 4.9 (Ø«Ù‚Ø©)</span>
                    </div>
                </div>
                <div style="text-align:left">
                    <b id="d-dist" style="color:#34c759">1.2 ÙƒÙ…</b><br>
                    <small style="color:#555">Ø§Ù„Ù…Ø³Ø§ÙØ©</small>
                </div>
            </div>
            <button class="btn" style="margin-top:15px; background:#34c759" onclick="showScr('scr-chat')">Ø¨Ø¯Ø¡ Ø§Ù„Ù…ÙØ§ÙˆØ¶Ø© (Ø¯Ø±Ø¯Ø´Ø©)</button>
        </div>

        <div class="tab-bar">
            <div class="tab active">ğŸ </div>
            <div class="tab" onclick="showScr('scr-chat')">ğŸ’¬</div>
            <div class="tab" onclick="showScr('scr-settings')">ğŸ‘¤</div>
        </div>
    </div>

    <div id="scr-chat" class="screen hidden">
        <div style="padding:15px; border-bottom:1px solid #222; display:flex; align-items:center; gap:15px">
            <button onclick="showScr('scr-home')" style="background:none; border:none; color:white; font-size:20px;">âœ•</button>
            <b>Ø§Ù„Ù…ÙØ§ÙˆØ¶Ø©: ÙÙ‡Ø¯ Ø§Ù„Ø´Ù…Ø±ÙŠ</b>
        </div>
        <div class="chat-box">
            <div class="bubble them">Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ…ØŒ Ø´ÙØª Ø·Ù„Ø¨Ùƒ. ÙƒÙ… Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù„ÙŠ Ø¨Ø®Ø§Ø·Ø±ÙƒØŸ</div>
            <div class="bubble me">ÙˆØ¹Ù„ÙŠÙƒÙ… Ø§Ù„Ø³Ù„Ø§Ù…ØŒ Ù…Ø¹ÙŠ Ø¬ÙŠØ¨ Ù…Ø¹Ø·Ù„. ÙˆØ´ Ø³Ø¹Ø±Ùƒ Ù„Ù„Ù…Ø´ÙˆØ§Ø±ØŸ</div>
            <div class="bubble them">Ù„Ø£Ø¬Ù„Ùƒ Ø¨Ù€ 150 Ø±ÙŠØ§Ù„.</div>
        </div>
        <div style="padding:15px; background:#1c1c1e; display:flex; gap:10px;">
            <input type="text" placeholder="Ø§ÙƒØªØ¨ Ø¹Ø±Ø¶Ùƒ Ù‡Ù†Ø§..." style="margin:0; text-align:right;">
            <button style="background:var(--primary); border:none; color:white; padding:0 20px; border-radius:15px;">Ø¥Ø±Ø³Ø§Ù„</button>
        </div>
    </div>

    <div id="scr-settings" class="screen hidden">
        <div style="padding:40px 20px; text-align:center;">
            <div style="width:90px; height:90px; background:var(--card); border-radius:50%; margin:0 auto 15px; display:flex; align-items:center; justify-content:center; border:2px solid var(--primary); font-size:30px;">ğŸ‘¤</div>
            <h2 id="u-name" onclick="editName()">Ù…Ø³ØªØ®Ø¯Ù… Ù„ÙˆÙƒØ§</h2>
            <p style="color:#555; margin-top:-10px;">05XXXXXXXX</p>
        </div>
        <div class="opt-row">Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª <div class="toggle on" onclick="this.classList.toggle('on')"></div></div>
        <div class="opt-row">ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ <div class="toggle on" onclick="this.classList.toggle('on')"></div></div>
        <div class="opt-row" onclick="alert('Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø­Ù‚ÙˆÙ‚: Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø´ÙØ±Ø© ÙˆØ¢Ù…Ù†Ø© Ù„Ø¶Ù…Ø§Ù† Ø­Ù‚ Ø§Ù„Ø·Ø±ÙÙŠÙ†.')">Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ§Ù„Ø­Ù‚ÙˆÙ‚ <span>ğŸ”’</span></div>
        <div class="opt-row" style="color:#ff3b30" onclick="location.reload()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ <span>ğŸšª</span></div>
        
        <div class="tab-bar">
            <div class="tab" onclick="showScr('scr-home')">ğŸ </div>
            <div class="tab" onclick="showScr('scr-chat')">ğŸ’¬</div>
            <div class="tab active">ğŸ‘¤</div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù€ Splash
        window.onload = () => {
            setTimeout(() => {
                document.getElementById('splash').style.opacity = '0';
                setTimeout(() => document.getElementById('splash').style.display = 'none', 600);
            }, 2500);
        };

        function showScr(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
            if(id === 'scr-home') initMap();
        }

        let map;
        function initMap() {
            if(map) return;
            map = L.map('map', { zoomControl: false }).setView([24.7136, 46.6753], 13);
            L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png').addTo(map);

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(pos => {
                    const { latitude, longitude } = pos.coords;
                    map.setView([latitude, longitude], 15);
                    L.circleMarker([latitude, longitude], { radius: 10, color: '#007aff', fillOpacity: 0.8 }).addTo(map);
                    
                    // Ù…Ø­Ø§ÙƒØ§Ø© ÙƒØ§Ø¨ØªÙ† Ù‚Ø±ÙŠØ¨
                    let m = L.marker([latitude + 0.005, longitude + 0.003]).addTo(map);
                    m.on('click', () => document.getElementById('driver-card').classList.add('active'));
                });
            }
        }

        function editName() {
            let n = prompt("Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„Ø¬Ø¯ÙŠØ¯:");
            if(n) document.getElementById('u-name').innerText = n;
        }

        // Ù…Ù†Ø¹ Ø§Ù‡ØªØ²Ø§Ø² Ø§Ù„ØµÙØ­Ø© ÙÙŠ Ø§Ù„Ø¢ÙŠÙÙˆÙ†
        document.addEventListener('touchmove', (e) => { if(e.target.tagName !== 'INPUT' && !e.target.closest('.chat-box')) e.preventDefault(); }, {passive: false});
    </script>
</body>
</html>
